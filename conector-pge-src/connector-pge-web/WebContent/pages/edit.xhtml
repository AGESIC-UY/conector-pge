<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:a="http://richfaces.org/a4j"
     xmlns:rich="http://richfaces.org/rich"
     xmlns:t="http://myfaces.apache.org/tomahawk"
     template="/templates/template.xhtml">		
     	
	<ui:define name="pageTitle">Init</ui:define>
	<ui:define name="pageHeader">Init</ui:define>

	<ui:define name="body">
		<h:form id="form1" enctype="multipart/form-data">
			<rich:toolTip value="#{msg.pathTooltip}" for="labelTooltipPath"/>
			<rich:toolTip value="#{msg.urlTooltip}" for="labelTooltipUrl"/>
			
			<h:panelGrid columns="4">
				<h:panelGroup>
					<h:outputLabel value="#{msg.name}"/><h:outputLabel value="*" rendered="#{not connector.editing}"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:inputText id="name" value="#{connector.connector.name}" required="true" validator="#{connector.validateName}" rendered="#{not connector.editing}">
						<f:validateLength maximum="100"/>
					</h:inputText>
					<h:outputLabel value="#{connector.connector.name}" rendered="#{connector.editing}" style="font-weight: bold;"/>
				</h:panelGroup>
				<h:message for="name" errorClass="fieldError"/>
				<rich:spacer/>

				<h:panelGroup>
					<h:outputLabel value="#{msg.type}"/><h:outputLabel value="*" rendered="#{not connector.editing}"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:selectOneListbox id="type" value="#{connector.connector.type}" size="1" rendered="#{not connector.editing}">
						<f:selectItem id="item1" itemLabel="#{connector.typeTestingLabel}" itemValue="#{connector.typeTesting}" />
						<f:selectItem id="item2" itemLabel="#{connector.typeProductionLabel}" itemValue="#{connector.typeProduction}" />
					</h:selectOneListbox>
					<h:outputLabel value="#{connector.connector.typeLabel}" rendered="#{connector.editing}" style="font-weight: bold;"/>
				</h:panelGroup>
				<h:message for="type" errorClass="fieldError"/>
				<rich:spacer/>

				<h:outputLabel value="#{msg.description}*"/>
				<h:inputTextarea id="description" value="#{connector.connector.description}" cols="95" rows="4" required="true">
					<f:validateLength maximum="800"/>
				</h:inputTextarea>
				<h:message for="description" errorClass="fieldError"/>
				<rich:spacer/>
				
				<h:outputLabel id="labelPath" value="#{msg.path} *"  styleClass="tooltipData" />
				<h:panelGroup>
					<h:inputText id="path" value="#{connector.connector.path}" required="true" size="90" >
						<f:validateLength maximum="100"/>
					</h:inputText>
					<rich:spacer/>
					<img id="labelTooltipPath" src="../img/question.png"/> 
				</h:panelGroup>
				<h:message for="path" errorClass="fieldError"/>
				<rich:spacer/>
				
				<h:outputLabel id="labelUrl" value="#{msg.url}" rendered="#{connector.editing}"/>
				<rich:panel id="urlPanel">
				<h:panelGroup rendered="#{connector.editing}">
					<h:outputLabel id="url" value="#{connector.connector.url}" size="90">
					</h:outputLabel>
					<rich:spacer/>
				</h:panelGroup>
				</rich:panel>
				<h:message for="url" errorClass="fieldError" rendered="#{connector.editing}"/>
				<rich:spacer rendered="#{connector.editing}"/>

				<rich:spacer/>
				<rich:spacer/>
				<rich:spacer/>
				<rich:spacer/>
				
				<rich:spacer/>
				<rich:spacer/>
				<rich:spacer/>
				<rich:spacer rendered="#{connector.editing}"/>			
				
									
				<h:outputLabel value="#{msg.wsaTo}*"/>
				<h:inputText id="wsa_to" value="#{connector.connector.wsaTo}" size="60" required="true" >
					<f:validateLength maximum="100"/>
				</h:inputText>
				<h:message for="wsa_to" errorClass="fieldError"/>
				<rich:spacer/>
									
				<h:outputLabel value="#{msg.username}*"/>
				<h:inputText id="username" value="#{connector.connector.username}" size="60" required="true">
					<f:validateLength maximum="100"/>
				</h:inputText>
				<h:message for="username" errorClass="fieldError"/>
				<rich:spacer/>
									
				<h:outputLabel value="#{msg.issuer}*"/>
				<h:inputText id="issuer" value="#{connector.connector.issuer}" size="60" required="true">
					<f:validateLength maximum="100"/>
				</h:inputText>
				<h:message for="issuer" errorClass="fieldError"/>
				<rich:spacer/>
									
				<h:outputLabel value="#{msg.policyName}*"/>
				<h:inputText id="policy_name" value="#{connector.connector.policyName}" size="60" required="true">
					<f:validateLength maximum="100"/>
				</h:inputText>
				<h:message for="policy_name" errorClass="fieldError"/>
				<rich:spacer/>
				
				<h:outputLabel value="#{msg.userNameTokenName}"/>
				<h:inputText id="userNameTokenName_ID" value="#{connector.connector.userNameTokenName}" size="60" required="false">
					<f:validateLength maximum="100"/>
				</h:inputText>
				<h:message for="userNameTokenName_ID" errorClass="fieldError"/>
				<rich:spacer/>

				<h:outputLabel value="#{msg.userNameTokenPassword}"/>
				<h:inputSecret id="userNameTokenPassword_ID" value="#{connector.userNameTokenPass}" size="60" redisplay="true" required="false">
					<f:validateLength maximum="100"/>
				</h:inputSecret>
				<h:message for="userNameTokenPassword_ID" errorClass="fieldError"/>
				<rich:spacer/>

				<h:outputLabel value="#{msg.aliasKeystore}*"/>
				<h:inputText id="alias" value="#{connector.connector.aliasKeystore}" size="60" required="true">
					<f:validateLength maximum="100"/>
				</h:inputText>
				<h:message for="alias" errorClass="fieldError"/>
				<rich:spacer/>
				
				<h:outputLabel value="#{msg.passKeystoreOrg}*"/>
				<h:inputSecret id="password_keystoreOrg" value="#{connector.keystoreOrganismoPass}" size="60" redisplay="true" required="true">
					<f:validateLength maximum="100"/>
				</h:inputSecret>
				<h:message for="password_keystoreOrg" errorClass="fieldError"/>
				<rich:spacer/>
				
				<h:outputLabel value="#{msg.passKeystore}*"/>
				<h:inputSecret id="password_keystore" value="#{connector.keystoreSSLPass}" size="60" redisplay="true" required="true">
					<f:validateLength maximum="100"/>
				</h:inputSecret>
				<h:message for="password_keystore" errorClass="fieldError"/>
				<rich:spacer/>

				<h:outputLabel value="#{msg.passKeystoreSsl}*"/>
				<h:inputSecret id="password_keystore_ssl" value="#{connector.trustorePass}" size="60" redisplay="true" required="true">
					<f:validateLength maximum="100"/>
				</h:inputSecret>
				<h:message for="password_keystore_ssl" errorClass="fieldError"/>
				<rich:spacer/>				
				
				<h:outputLabel value="#{msg.wsdl}*"/>
				<h:panelGroup>
					<t:inputFileUpload id="wsdlFile" storage="file" 
						value="#{connector.wsdlUploadFile}" required="#{not connector.connector.existWsdl}" size="40" style="margin-right:5px;"/>
					<h:outputLink value="#{facesContext.externalContext.requestContextPath}/fileDownload?type=#{connector.connector.type}&amp;name=#{connector.connector.name}&amp;fileName=#{connector.pathWsdl}" 
							rendered="#{connector.editing and connector.connector.existWsdl}" style="margin-right:5px;"><img src="../img/download.png" alt="#{msg.download}" title="#{msg.download}"/>Descargar</h:outputLink>
					<h:commandButton action="#{connector.refreshInfoFromWSDL}" value="Carga el WSDL y refresca los datos relativos a este." image="../img/refresh.gif" label="Cargar" title="Carga el WSDL y refresca las operacions y la URL.">
					</h:commandButton>							
				</h:panelGroup>
				<h:message for="wsdlFile" errorClass="fieldError"/>
				<rich:spacer/>					

				<h:outputLabel value="#{msg.keystoreOrg}*"/>
				<h:panelGroup id="keystoreOrganismo">
					<t:inputFileUpload id="keystoreOrgFile" storage="file" required="#{not connector.connector.existKeystoreOrg}" 
						value="#{connector.keystoreOrgUploadFile}" size="40" style="margin-right:5px;"/>
					<h:outputLink value="#{facesContext.externalContext.requestContextPath}/fileDownload?type=#{connector.connector.type}&amp;name=#{connector.connector.name}&amp;fileName=#{connector.pathKeystoreOrg}" 
							rendered="#{connector.editing and connector.connector.existKeystoreOrg}" style="margin-right:5px;"><img src="../img/download.png" alt="#{msg.download}" title="#{msg.download}" />Descargar</h:outputLink>
				</h:panelGroup>
				<h:message for="keystoreFile" errorClass="fieldError"/>
				<rich:spacer/>
				
				<h:outputLabel value="#{msg.keystore}*"/>
				<h:panelGroup>
					<t:inputFileUpload id="keystoreFile" storage="file" required="#{not connector.connector.existKeystore}" 
						value="#{connector.keystoreUploadFile}" size="40" style="margin-right:5px;"/>
					<h:outputLink value="#{facesContext.externalContext.requestContextPath}/fileDownload?type=#{connector.connector.type}&amp;name=#{connector.connector.name}&amp;fileName=#{connector.pathKeystore}" 
							rendered="#{connector.editing and connector.connector.existKeystore}" style="margin-right:5px;"><img src="../img/download.png" alt="#{msg.download}" title="#{msg.download}"/>Descargar</h:outputLink>
				</h:panelGroup>
				<h:message for="keystoreFile" errorClass="fieldError"/>
				<rich:spacer/>				
				
				<h:outputLabel value="#{msg.keystoreSsl}*"/>
				<h:panelGroup>
					<t:inputFileUpload id="keystoreSslFile" storage="file" required="#{not connector.connector.existKeystoreSsl}" 
						value="#{connector.keystoreSslUploadFile}" size="40" style="margin-right:5px;"/>
					<h:outputLink value="#{facesContext.externalContext.requestContextPath}/fileDownload?type=#{connector.connector.type}&amp;name=#{connector.connector.name}&amp;fileName=#{connector.pathKeystoreSsl}" 
							rendered="#{connector.editing and connector.connector.existKeystoreSsl}" style="margin-right:5px;"><img src="../img/download.png" alt="#{msg.download}" title="#{msg.download}"/>Descargar</h:outputLink>
				</h:panelGroup>
				<h:message for="keystoreSslFile" errorClass="fieldError"/>
				<rich:spacer/>				
				
				<rich:spacer/>
				<br/>
				<rich:spacer/>
				<rich:spacer/>				
				
				
			</h:panelGrid>
			
			<rich:panel >
				<f:facet name="header" >
					<h:outputText value="#{msg.roleOperator}" />
				</f:facet>
				<h:panelGroup >
					<h:panelGrid columns="3" style="width:70%">					
						<rich:spacer width="50px"/>
						<a:region id="roleRegion">
							<rich:dataTable id="tableRoleOperation" value="#{connector.connector.role_operation}" var="rl" width="100%" rowClasses="even, odd">
							  <h:column style="width:33%">
							    <f:facet name="header">
							      <h:outputText value="#{msg.roleOnly}" />
							    </f:facet>
							    <h:inputText id="roleTableID" value="#{rl.role}" required="true"/>
							    <h:message for="roleTableID" errorClass="fieldError"/>
							  </h:column>
							  <h:column style="width:33%">
							    <f:facet name="header">
							      <h:outputText value="#{msg.wsaAction}" />
							    </f:facet>
							    <h:inputText id="wsaActionTableID" value="#{rl.wsaAction}" required="true"/>
							    <h:message for="wsaActionTableID" errorClass="fieldError"/>
							  </h:column>
							  <h:column style="width:33%">
							    <f:facet name="header">
							      <h:outputText value="#{msg.operator}" />
							    </f:facet>
							    <h:outputText value="#{rl.operationFromWSDL}" />
							  </h:column>
							</rich:dataTable>							
						</a:region>					
					</h:panelGrid>					
				</h:panelGroup>
			</rich:panel>
			
			<br />
			<br />
               <div align="center">
				<h:commandButton action="home" value="#{msg.cancel}" immediate="true" onclick="if (!confirm('Los campos modificados (si los hay) no ser&#225;n guardados. Confirma?')) return false;"/>
				&#160;&#160;&#160;
				<h:commandButton action="#{connector.save}" value="#{msg.save}"/>
				&#160;&#160;&#160;
				<h:commandButton action="#{connector.delete}" value="#{msg.delete}" immediate="true" onclick="if (!confirm('Est&#243; seguro que desea eliminar el Connector?')) return false;"/>
				&#160;&#160;&#160;
				
			</div>			
			
		</h:form>		
			<rich:modalPanel id="newRoleOperation">
				<f:facet name="header" >
					<h:outputText value="#{msg.roleOperator}" />
				</f:facet>
				<h:form>
					<h:panelGroup>
						<h:panelGrid columns="5">
							<h:outputText value="#{msg.roleOnly}*: " />
							<h:inputText id="roleEdit" value="#{connector.rlToEdit.role}" required="true">
								<f:validateLength maximum="100"/>
							</h:inputText>
							<h:message for="roleEdit" errorClass="fieldError"/>
							<rich:spacer/>
							
							<h:outputLabel value="#{msg.wsaAction}*"/>
							<h:inputText id="wsa_action" value="#{connector.rlToEdit.wsaAction}" size="60" required="true">
								<f:validateLength maximum="100"/>
							</h:inputText>
							<h:message for="wsa_action" errorClass="fieldError"/>
							<rich:spacer/>							
							
							<h:outputText value="#{msg.operator}*: " />
							<h:inputText id="opeEdit" value="#{connector.rlToEdit.operation}" required="true">
								<f:validateLength maximum="100"/>
							</h:inputText>
							<h:message for="opeEdit" errorClass="fieldError"/>
							<rich:spacer/>
							
							<a:commandButton value="#{msg.cancel}" onclick="Richfaces.hideModalPanel('newRoleOperation');" immediate="true"/>
							<h:panelGroup id="botonAceptar">
								<a:commandButton value="#{msg.save}" action="#{connector.editRoleOperation}" 
								oncomplete="if (!ajaxRequestContainsErrors()) Richfaces.hideModalPanel('newRoleOperation');" reRender="tableRoleOperation" />
							</h:panelGroup>
							<rich:spacer/>
						</h:panelGrid>
					</h:panelGroup>
				</h:form>
			</rich:modalPanel>

	</ui:define>
</ui:composition>